{
  "meta": {
    "instanceId": "d4d7965840e96e50a3e02959a8487c692901dfa8d5cc294134442c67ce1622d3",
    "templateCredsSetupCompleted": true
  },
  "nodes": [
    {
      "id": "9252c041-d6b2-49fe-8edb-8d8cb8a1341d",
      "name": "Lors de la soumission du formulaire",
      "type": "n8n-nodes-base.formTrigger",
      "position": [
        240,
        0
      ],
      "webhookId": "0c5c8b39-06a7-4d07-95be-b729d2a9eb6f",
      "parameters": {
        "options": {},
        "formTitle": "Batch File Upload to Google Drive",
        "formFields": {
          "values": [
            {
              "fieldType": "file",
              "fieldLabel": "file",
              "requiredField": true
            },
            {
              "fieldLabel": "folderName",
              "requiredField": true
            }
          ]
        },
        "formDescription": "Use this form to upload multiple files to a specific Google Drive folder. Simply select your files and specify your target folder name. If the folder doesn't exist yet, we'll create it automatically for you. This streamlined process allows you to organize and store multiple files in one go, saving you time and effort."
      },
      "typeVersion": 2.2
    },
    {
      "id": "e27712ac-238d-4b45-b842-a044dc40dccd",
      "name": "Obtenir le nom du dossier",
      "type": "n8n-nodes-base.set",
      "position": [
        560,
        0
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "1b997842-86f3-4bce-b8d2-e8d73387dae1",
              "name": "folderName",
              "type": "string",
              "value": "={{ $json.folderName }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "555e761a-ea79-40eb-b36f-72fbcc642fda",
      "name": "Rechercher un dossier sp√©cifique",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        800,
        0
      ],
      "parameters": {
        "filter": {},
        "options": {},
        "resource": "fileFolder",
        "queryString": "=mimeType='application/vnd.google-apps.folder' and name = '{{ $json.folderName }}' and '<folderId>' in parents\n",
        "searchMethod": "query"
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "2SIFnsVfdw9nx9I4",
          "name": "Google Drive account"
        }
      },
      "executeOnce": false,
      "typeVersion": 3,
      "alwaysOutputData": true
    },
    {
      "id": "2a92c031-44e5-4e07-89ff-058251c43027",
      "name": "Dossier trouv√© ?",
      "type": "n8n-nodes-base.if",
      "position": [
        1280,
        0
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "11abd7e3-d90b-4bb1-a8ba-d3cbc4333d8f",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              },
              "leftValue": "={{ $json }}",
              "rightValue": ""
            }
          ]
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "e413cdc8-8424-41d3-8791-e036392a16ac",
      "name": "Cr√©er un dossier",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        1680,
        100
      ],
      "parameters": {
        "name": "={{ $('On form submission').item.json.folderName }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "options": {},
        "folderId": {
          "__rl": true,
          "mode": "list",
          "value": "17sGS9HdmAtgpd5rC1sVuiIUGyw2hq9IY",
          "cachedResultUrl": "https://drive.google.com/drive/folders/17sGS9HdmAtgpd5rC1sVuiIUGyw2hq9IY",
          "cachedResultName": "n8n"
        },
        "resource": "folder"
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "2SIFnsVfdw9nx9I4",
          "name": "Google Drive account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "aada549c-3bbd-453b-9d48-4ab25446d8ce",
      "name": "T√©l√©verser des fichiers",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        2180,
        -100
      ],
      "parameters": {
        "name": "={{ $json.fileName }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "options": {},
        "folderId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Search specific folder').item.json.id }}"
        },
        "inputDataFieldName": "=data"
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "2SIFnsVfdw9nx9I4",
          "name": "Google Drive account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "7b4bcb6e-3b63-4243-8f38-a18f3d5d44f2",
      "name": "Pr√©parer les fichiers pour le t√©l√©versement",
      "type": "n8n-nodes-base.code",
      "position": [
        1920,
        -100
      ],
      "parameters": {
        "jsCode": "let results = [];\nconst items = $(\"On form submission\").all()\n\nfor (item of items) {\n    for (key of Object.keys(item.binary)) {\n        results.push({\n            json: {\n                fileName: item.binary[key].fileName\n            },\n            binary: {\n                data: item.binary[key],\n            }\n        });\n    }\n}\n\nreturn results;"
      },
      "typeVersion": 2
    },
    {
      "id": "1d08ef78-68e7-4901-80fc-17923344fee3",
      "name": "Pr√©parer les fichiers pour le nouveau dossier",
      "type": "n8n-nodes-base.code",
      "position": [
        1920,
        100
      ],
      "parameters": {
        "jsCode": "let results = [];\nconst items = $(\"On form submission\").all()\n\nfor (item of items) {\n    for (key of Object.keys(item.binary)) {\n        results.push({\n            json: {\n                fileName: item.binary[key].fileName\n            },\n            binary: {\n                data: item.binary[key],\n            }\n        });\n    }\n}\n\nreturn results;"
      },
      "typeVersion": 2
    },
    {
      "id": "557d2c63-7bbb-4280-b16e-71c6d900973b",
      "name": "T√©l√©verser dans le nouveau dossier",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        2180,
        100
      ],
      "parameters": {
        "name": "={{ $json.fileName }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "options": {},
        "folderId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Create Folder').item.json.id }}"
        },
        "inputDataFieldName": "=data"
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "2SIFnsVfdw9nx9I4",
          "name": "Google Drive account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "e90ccfb0-cf21-45d2-860e-bc2049ed9682",
      "name": "Note autocollante",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -400,
        -200
      ],
      "parameters": {
        "color": 5,
        "width": 520,
        "height": 520,
        "content": "# üóÇÔ∏è T√©l√©versement en masse de fichiers sur Google Drive avec gestion des dossiers\n\n## Vue d'ensemble\nCe workflow traite une soumission de formulaire qui accepte :\n- Plusieurs fichiers t√©l√©vers√©s (tout format)\n- Saisie du nom du dossier cible\n\nLe workflow effectue automatiquement :\n- V√©rifie si le dossier sp√©cifi√© existe dans Google Drive\n- Cr√©e le dossier s'il n'existe pas\n- T√©l√©verse tous les fichiers dans le dossier correct\n- Conserve les noms et la structure d'origine des fichiers\n\nParfait pour t√©l√©verser en masse des fichiers tout en gardant votre Drive organis√© !"
      },
      "typeVersion": 1
    },
    {
      "id": "cd00c8a3-42e3-44f4-89b3-663da809346c",
      "name": "Note autocollante1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1100,
        -440
      ],
      "parameters": {
        "color": 5,
        "width": 460,
        "height": 380,
        "content": "## üîÑ Point de d√©cision : V√©rification du dossier\nLe workflow se divise en deux chemins selon l'existence du dossier :\n- ‚úÖ VRAI : Utiliser le chemin du dossier existant\n- üÜï FAUX : Cr√©er un nouveau chemin de dossier\n\n## üóÇÔ∏è Chemin du dossier existant (en haut)\n1. Pr√©parer les fichiers pour le t√©l√©versement : Divise les fichiers pour un traitement individuel\n2. T√©l√©verser les fichiers : T√©l√©verse dans le dossier existant en conservant la structure\n\n## üìÅ Nouveau chemin de dossier (en bas)\n1. Cr√©er un dossier : G√©n√®re un nouveau dossier dans Drive\n2. Pr√©parer les fichiers pour le nouveau dossier : Divise les fichiers pour un traitement individuel\n3. T√©l√©verser dans le nouveau dossier : T√©l√©verse dans le dossier nouvellement cr√©√©"
      },
      "typeVersion": 1
    },
    {
      "id": "a0b1ff8a-3308-41da-bb4b-01b50cccc456",
      "name": "Note Autocollante2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1920,
        -340
      ],
      "parameters": {
        "color": 5,
        "width": 360,
        "height": 200,
        "content": "## ‚öôÔ∏è Notes sur le traitement des fichiers\n- Tous les fichiers binaires sont divis√©s individuellement pour une gestion correcte du t√©l√©chargement\n- Les noms de fichiers originaux et la structure sont pr√©serv√©s\n- Les deux chemins garantissent une organisation de fichiers identique\n\nvoir aussi https://n8n.io/workflows/1621-split-out-binary-data/"
      },
      "typeVersion": 1
    },
    {
      "id": "c16b2105-638d-4d48-b39d-ff8772375674",
      "name": "Note Autocollante4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        400,
        -340
      ],
      "parameters": {
        "color": 5,
        "width": 660,
        "height": 280,
        "content": "## üîç Mod√®le de requ√™te de recherche\n\nLe mod√®le de recherche suivant cherche un dossier avec le nom sp√©cifi√© dans un dossier parent particulier :\nAssurez-vous de remplacer <folderId>\n\n```javascript\nmimeType='application/vnd.google-apps.folder' and name = '{{ $json.folderName }}' and '<folderId>' in parents\n```\n\n**Important** : Toujours produire des donn√©es pour que vous puissiez v√©rifier √©galement si rien n‚Äôest trouv√©."
      },
      "typeVersion": 1
    }
  ],
  "pinData": {},
  "connections": {
    "Cr√©er un dossier": {
      "main": [
        [
          {
            "node": "Pr√©parer les fichiers pour le nouveau dossier",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Dossier trouv√© ?": {
      "main": [
        [
          {
            "node": "Pr√©parer les fichiers pour le t√©l√©versement",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cr√©er un dossier",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtenir le nom du dossier": {
      "main": [
        [
          {
            "node": "Rechercher un dossier sp√©cifique",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Lors de la soumission du formulaire": {
      "main": [
        [
          {
            "node": "Obtenir le nom du dossier",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Rechercher un dossier sp√©cifique": {
      "main": [
        [
          {
            "node": "Dossier trouv√© ?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pr√©parer les fichiers pour le t√©l√©versement": {
      "main": [
        [
          {
            "node": "T√©l√©verser des fichiers",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pr√©parer les fichiers pour le nouveau dossier": {
      "main": [
        [
          {
            "node": "T√©l√©verser dans le nouveau dossier",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "tags": [
    {
      "id": "1",
      "name": "Audelalia"
    }
  ]
}